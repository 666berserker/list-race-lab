### üõ†Ô∏è CONFIGURACI√ìN GENERAL DEL SERVIDOR NGINX

# Usuario del sistema que ejecuta el proceso Nginx
user www-data;

# Usa autom√°ticamente un proceso por CPU disponible
worker_processes auto;

# Archivo que almacena el ID del proceso principal de Nginx
pid /run/nginx.pid;

# Registro de errores
error_log /var/log/nginx/error.log;

# Carga m√≥dulos adicionales habilitados
include /etc/nginx/modules-enabled/*.conf;


### ‚ö° CONFIGURACI√ìN DE EVENTOS
events {
    worker_connections 768;  # N√∫mero m√°ximo de conexiones simult√°neas por worker
    multi_accept on;         # Aceptar m√∫ltiples conexiones simult√°neamente
}


### üåç CONFIGURACI√ìN GLOBAL HTTP
http {

    ## üîπ CONFIGURACIONES B√ÅSICAS
    sendfile on;                   # Optimizaci√≥n de transferencia de archivos
    tcp_nopush on;                  # Reducci√≥n de latencia al enviar datos grandes
    tcp_nodelay on;                 # Mejora tiempos de respuesta en conexiones peque√±as
    keepalive_timeout 65;            # Tiempo de espera para conexiones KeepAlive
    types_hash_max_size 2048;        # Optimizaci√≥n del tama√±o del hash de tipos MIME

    ## üíæ CONFIGURACI√ìN DE CACH√â EN DISCO (CDN)
    proxy_cache_path /var/cache/nginx/cdn_proxy   # Ubicaci√≥n f√≠sica del cach√©
                    levels=1:2                    # Estructura de directorios (2 niveles)
                    keys_zone=cdn_proxy:10m       # Espacio en memoria para √≠ndices de cach√©
                    max_size=500m                 # Tama√±o m√°ximo en disco
                    inactive=60m                  # Tiempo antes de eliminar contenido sin usar
                    use_temp_path=off;            # No usar directorio temporal

    ## üìÅ TIPOS DE ARCHIVOS Y CONFIGURACIONES ADICIONALES
    include /etc/nginx/mime.types;    # Mapeo de extensiones a tipos MIME
    default_type application/octet-stream;  # Tipo por defecto para archivos desconocidos

    ## üîê SEGURIDAD SSL (FUTURA IMPLEMENTACI√ìN)
    # ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;  # Eliminando SSLv3 (POODLE vulnerability)
    # ssl_prefer_server_ciphers on;

    ## üìú REGISTROS DE ACCESO
    access_log /var/log/nginx/access.log;

    ## üöÄ OPTIMIZACI√ìN DE RENDIMIENTO
    # Compresi√≥n Gzip para reducir tama√±o de transferencia
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss image/svg+xml;
    gzip_vary on;

    ## üåê INCLUSI√ìN DE VIRTUAL HOSTS
    include /etc/nginx/conf.d/*.conf;        # Incluir configuraciones generales de Nginx
    include /etc/nginx/sites-enabled/cdn-proxy;  # Incluir configuraci√≥n espec√≠fica del proxy CDN

    ## üõ°Ô∏è FUTURAS MEJORAS EN SEGURIDAD (A IMPLEMENTAR POSTERIORMENTE)
    # üîπ Configuraci√≥n HTTPS con certificados SSL
    # üîπ Protecci√≥n contra ataques DDoS y rate-limiting
    # üîπ Seguridad avanzada con headers HTTP
    # üîπ Implementaci√≥n de pol√≠ticas de cach√© m√°s estrictas
}
